{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _getIterator from \"@babel/runtime-corejs2/core-js/get-iterator\";\nimport { ADALA, NAUTIJON, MANGASNEWS } from '../rss';\nimport adala from '../public/img/adala.png';\nimport { fetchRss } from './Shared';\nimport Axios from 'axios';\nimport { API } from '../api';\nexport var getApiNews = function getApiNews() {\n  var _ref, data, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, item;\n\n  return _regeneratorRuntime.async(function getApiNews$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(Axios.get(\"\".concat(API, \"/api/news\")));\n\n        case 3:\n          _ref = _context.sent;\n          data = _ref.data;\n\n          if (!data) {\n            _context.next = 25;\n            break;\n          }\n\n          _iteratorNormalCompletion = true;\n          _didIteratorError = false;\n          _iteratorError = undefined;\n          _context.prev = 9;\n\n          for (_iterator = _getIterator(datas); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            item = _step.value;\n\n            if (item.site === 'Adala-news') {\n              item.img = adala;\n            }\n          }\n\n          _context.next = 17;\n          break;\n\n        case 13:\n          _context.prev = 13;\n          _context.t0 = _context[\"catch\"](9);\n          _didIteratorError = true;\n          _iteratorError = _context.t0;\n\n        case 17:\n          _context.prev = 17;\n          _context.prev = 18;\n\n          if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n            _iterator[\"return\"]();\n          }\n\n        case 20:\n          _context.prev = 20;\n\n          if (!_didIteratorError) {\n            _context.next = 23;\n            break;\n          }\n\n          throw _iteratorError;\n\n        case 23:\n          return _context.finish(20);\n\n        case 24:\n          return _context.finish(17);\n\n        case 25:\n          return _context.abrupt(\"return\", data);\n\n        case 28:\n          _context.prev = 28;\n          _context.t1 = _context[\"catch\"](0);\n          console.log(_context.t1);\n\n        case 31:\n          return _context.abrupt(\"return\", []);\n\n        case 32:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[0, 28], [9, 13, 17, 25], [18,, 20, 24]]);\n};\nexport var getNews = function getNews() {\n  var news, adala, nautijon, mangasNews, cache;\n  return _regeneratorRuntime.async(function getNews$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          news = [];\n          _context2.next = 3;\n          return _regeneratorRuntime.awrap(getAdalaNews());\n\n        case 3:\n          adala = _context2.sent;\n          _context2.next = 6;\n          return _regeneratorRuntime.awrap(getNautijonNews());\n\n        case 6:\n          nautijon = _context2.sent;\n          _context2.next = 9;\n          return _regeneratorRuntime.awrap(getMangasNews());\n\n        case 9:\n          mangasNews = _context2.sent;\n          news = news.concat(adala, nautijon, mangasNews);\n          news.sort(function (a, b) {\n            return new Date(b.pubDate) - new Date(a.pubDate);\n          });\n          cache = JSON.parse(localStorage.getItem('cache'));\n          cache.news = news;\n          cache.newsDate = new Date();\n          localStorage.setItem('cache', _JSON$stringify(cache));\n          return _context2.abrupt(\"return\", news);\n\n        case 17:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n};\n\nvar getAdalaNews = function getAdalaNews() {\n  var json, datas;\n  return _regeneratorRuntime.async(function getAdalaNews$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return _regeneratorRuntime.awrap(fetchRss(ADALA));\n\n        case 2:\n          json = _context3.sent;\n          datas = formatJsonAdala(json);\n          return _context3.abrupt(\"return\", datas);\n\n        case 5:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n};\n\nvar getNautijonNews = function getNautijonNews() {\n  var json, datas;\n  return _regeneratorRuntime.async(function getNautijonNews$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return _regeneratorRuntime.awrap(fetchRss(NAUTIJON));\n\n        case 2:\n          json = _context4.sent;\n          datas = formatJsonNautijon(json);\n          return _context4.abrupt(\"return\", datas);\n\n        case 5:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  });\n};\n\nvar getMangasNews = function getMangasNews() {\n  var json, datas;\n  return _regeneratorRuntime.async(function getMangasNews$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return _regeneratorRuntime.awrap(fetchRss(MANGASNEWS));\n\n        case 2:\n          json = _context5.sent;\n          datas = formatJsonMangasNews(json);\n          return _context5.abrupt(\"return\", datas);\n\n        case 5:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  });\n};\n\nvar formatJsonAdala = function formatJsonAdala(json) {\n  var array = [];\n  var items = json.rss.channel.item;\n\n  for (var i = 0; i < items.length; i++) {\n    var item = {\n      title: items[i].title['_text'],\n      desc: items[i].description['_cdata'],\n      link: items[i].link['_text'],\n      pubDate: items[i].pubDate['_text'],\n      category: items[i].category[0]['_cdata'],\n      site: 'Adala-news',\n      img: adala\n    };\n    array.push(item);\n  }\n\n  return array;\n};\n\nvar formatJsonNautijon = function formatJsonNautijon(json) {\n  var array = [];\n  var items = json.rss.channel.item;\n\n  for (var i = 0; i < items.length; i++) {\n    var desc = items[i].description['_cdata'].split('<br />');\n    var src = desc[0].match('(https.*.jpg)');\n    var item = {\n      title: items[i].title['_text'],\n      desc: desc[1],\n      link: items[i].link['_text'],\n      pubDate: items[i].pubDate['_text'],\n      site: 'Nautijon',\n      img: src[0]\n    };\n    array.push(item);\n  }\n\n  return array;\n};\n\nvar formatJsonMangasNews = function formatJsonMangasNews(json) {\n  var array = [];\n  var items = json.rss.channel.item;\n\n  for (var i = 0; i < items.length; i++) {\n    var desc = items[i].description['_cdata'].split('<p>');\n    var src = desc[0].match('(https.*.jpg)');\n    var item = {\n      title: items[i].title['_text'],\n      desc: desc[1].replace('</p>', ''),\n      link: items[i].link['_text'],\n      pubDate: items[i].pubDate['_text'],\n      site: 'Mangas-News',\n      img: src ? src[0] : adala\n    };\n    array.push(item);\n  }\n\n  return array;\n};","map":{"version":3,"sources":["/Users/kevhoque/Documents/MyTest/myJapan/helpers/News.js"],"names":["ADALA","NAUTIJON","MANGASNEWS","adala","fetchRss","Axios","API","getApiNews","get","data","datas","item","site","img","console","log","getNews","news","getAdalaNews","getNautijonNews","nautijon","getMangasNews","mangasNews","concat","sort","a","b","Date","pubDate","cache","JSON","parse","localStorage","getItem","newsDate","setItem","json","formatJsonAdala","formatJsonNautijon","formatJsonMangasNews","array","items","rss","channel","i","length","title","desc","description","link","category","push","split","src","match","replace"],"mappings":"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","sourcesContent":["\nimport { ADALA, NAUTIJON, MANGASNEWS } from '../rss';\nimport adala from '../public/img/adala.png';\nimport { fetchRss } from './Shared'\nimport Axios from 'axios';\nimport { API } from '../api'\n\nexport const getApiNews = async() => {\n    try {\n        const { data } = await Axios.get(`${API}/api/news`)\n        if(data) {\n            for(let item of datas) {\n                if(item.site === 'Adala-news') {\n                    item.img = adala\n                }\n            }\n        }\n        return data\n    } catch(e) {\n        console.log(e)\n    }\n\n    return []\n}\n\nexport const getNews = async () => {\n    let news = []\n    let adala = await getAdalaNews()\n    let nautijon = await getNautijonNews()\n    let mangasNews = await getMangasNews()\n\n    news = news.concat(adala, nautijon, mangasNews)\n\n    news.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate))\n\n    let cache = JSON.parse(localStorage.getItem('cache'))\n    cache.news = news\n    cache.newsDate = new Date()\n    localStorage.setItem('cache', JSON.stringify(cache))\n\n    return news\n}\n\nconst getAdalaNews = async () => {\n    let json = await fetchRss(ADALA)\n    let datas = formatJsonAdala(json)\n    return datas\n}\n\nconst getNautijonNews = async () => {\n    let json = await fetchRss(NAUTIJON)\n    let datas = formatJsonNautijon(json)\n    return datas\n}\n\nconst getMangasNews = async () => {\n    let json = await fetchRss(MANGASNEWS)\n    let datas = formatJsonMangasNews(json)\n    return datas\n}\n\nconst formatJsonAdala = (json) => {\n    let array = []\n    const items = json.rss.channel.item\n    for(var i = 0; i < items.length; i++) {\n        let item = {\n            title: items[i].title['_text'],\n            desc: items[i].description['_cdata'],\n            link: items[i].link['_text'],\n            pubDate: items[i].pubDate['_text'],\n            category: items[i].category[0]['_cdata'],\n            site: 'Adala-news',\n            img: adala\n        }\n        array.push(item)\n    }\n    return array\n}\n\nconst formatJsonNautijon = (json) => {\n    let array = []\n    const items = json.rss.channel.item\n    for(var i = 0; i < items.length; i++) {\n        const desc = items[i].description['_cdata'].split('<br />')\n        const src = desc[0].match('(https.*.jpg)')\n        let item = {\n            title: items[i].title['_text'],\n            desc: desc[1],\n            link: items[i].link['_text'],\n            pubDate: items[i].pubDate['_text'],\n            site: 'Nautijon',\n            img: src[0]\n        }\n        array.push(item)\n    }\n    return array\n}\n\nconst formatJsonMangasNews = (json) => {\n    let array = []\n    const items = json.rss.channel.item\n    for(var i = 0; i < items.length; i++) {\n        const desc = items[i].description['_cdata'].split('<p>')\n        const src = desc[0].match('(https.*.jpg)')\n        let item = {\n            title: items[i].title['_text'],\n            desc: desc[1].replace('</p>', ''),\n            link: items[i].link['_text'],\n            pubDate: items[i].pubDate['_text'],\n            site: 'Mangas-News',\n            img: src ? src[0] : adala\n        }\n        array.push(item)\n    }\n    return array\n}"]},"metadata":{},"sourceType":"module"}